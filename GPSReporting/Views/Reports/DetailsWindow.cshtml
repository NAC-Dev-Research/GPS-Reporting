@model GPSReporting.Models.ReportsViewModel
<br />
<br />

@using (Html.BeginForm("DetailsWindow", "Reports", FormMethod.Post))
{
    <button class="btn btn-outline-primary" name="backToMenu" value="Yes">Back to summary page</button>
    <button class="btn btn-outline-success" name="downReport" value="YES" onclick="GenerateExcel()">Download Report</button>
}
@{
    if (Model.CurrentWindow == "USAGE")
    {
        <p align="center"><strong><span style="font-size: 18pt">By Vehicle Usage</span></strong></p>
        <table class="taskList" style="width: 98%; border-collapse: collapse" bordercolor="black" cellspacing="0" cellpadding="1" align="center" border="1">
            <tbody>
                <tr style="background-color:#bfffdb">
                    <td style="text-align:center" rowspan="1" colspan="8"><strong>Vehicle Usage &nbsp; ( Start date: @Model.DateFROM.Value.ToString("yyyy-MM-dd") &nbsp; - &nbsp; End date: @Model.DateTO.Value.ToString("yyyy-MM-dd") )</strong></td>
                </tr>
                <tr style="background-color: #e1f2d4">
                    <td style="text-align:center" width="3%" rowspan="2" colspan="1"><strong></strong></td>
                    <td style="text-align:center" width="20%" rowspan="2" colspan="1"><strong>Vehicle</strong></td>
                    <td style="text-align:center" width="10%" rowspan="2" colspan="1"><strong>Number of trips</strong></td>
                    <td style="text-align:center" width="30%" rowspan="1" colspan="2"><strong>Mileage, km</strong></td>
                    <td style="text-align:center" width="30%" rowspan="1" colspan="2"><strong>Travel time, hh:mm:ss</strong></td>
                    <td style="text-align:center" width="10%" rowspan="2" colspan="1"><strong>Details</strong></td>
                </tr>
                <tr style="background-color: #e1f2d4">
                    <td style="text-align:center" width="15%" rowspan="1"><strong>Total</strong></td>
                    <td style="text-align:center" width="15%" rowspan="1"><strong>Average</strong></td>
                    <td style="text-align:center" width="15%" rowspan="1"><strong>Total</strong></td>
                    <td style="text-align:center" width="15%" rowspan="1"><strong>Average</strong></td>
                </tr>
                @{
                    if (Model._tripReportRaw != null)
                    {
                        int count = 1;
                        foreach (var item in Model._vehicleUsageList)
                        {
                            <tr>
                                <td style="text-align:center">@count</td>
                                <td style="text-align:center">@Html.DisplayFor(m => item.VehicleID) - @Html.DisplayFor(m => item.VehicleModel)</td>
                                <td style="text-align:center">@Html.DisplayFor(m => item.NumberOfTrips)</td>
                                <td style="text-align:center">@Html.DisplayFor(m => item.TotalMileage)</td>
                                <td style="text-align:center">@Html.DisplayFor(m => item.AverageMileage)</td>
                                <td style="text-align:center">@Html.DisplayFor(m => item.TotalTravelTime)</td>
                                <td style="text-align:center">@Html.DisplayFor(m => item.AverageTravelTime)</td>
                                <td style="text-align:center">@Html.ActionLink("Go to details", "VehicleUsageBreakdown", new { vehicleID = item.VehicleID })</td>
                            </tr>
                            count++;
                        }
                    }
                }
            </tbody>
        </table>

        <br /><br /><br />
        <p align="center"><strong><span style="font-size: 18pt">Usage By Time Range (trip start time basis)</span></strong></p>
        <table class="taskList" style="width: 98%; border-collapse: collapse" bordercolor="black" cellspacing="0" cellpadding="1" align="center" border="1">
            <tbody>
                <tr style="background-color:#bfffdb">
                    <td style="text-align:center" rowspan="1" colspan="6"><strong>Usage by Time Range &nbsp; ( Start date: @Model.DateFROM.Value.ToString("yyyy-MM-dd") &nbsp; - &nbsp; End date: @Model.DateTO.Value.ToString("yyyy-MM-dd") )</strong></td>
                </tr>
                <tr style="background-color: #e1f2d4">
                    <td style="text-align:center" width="15%" rowspan="2" colspan="1"><strong>Time Range</strong></td>
                    <td style="text-align:center" width="15%" rowspan="2" colspan="1"><strong>Number of trips</strong></td>
                    <td style="text-align:center" width="35%" rowspan="1" colspan="2"><strong>Mileage, km</strong></td>
                    <td style="text-align:center" width="35%" rowspan="1" colspan="2"><strong>Travel time, hh:mm:ss</strong></td>
                </tr>
                <tr style="background-color: #e1f2d4">
                    <td style="text-align:center" width="17%" rowspan="1"><strong>Total</strong></td>
                    <td style="text-align:center" width="17%" rowspan="1"><strong>Average</strong></td>
                    <td style="text-align:center" width="17%" rowspan="1"><strong>Total</strong></td>
                    <td style="text-align:center" width="17%" rowspan="1"><strong>Average</strong></td>
                </tr>
                @{
                    if (Model._tripReportRaw != null)
                    {
                        foreach (var item in Model._usageByTimeRangeList)
                        {
                            <tr>
                                <td style="text-align:center">@Html.DisplayFor(m => item.TimeRange)</td>
                                <td style="text-align:center">@Html.DisplayFor(m => item.NumberOfTrips)</td>
                                <td style="text-align:center">@Html.DisplayFor(m => item.TotalMileage)</td>
                                <td style="text-align:center">@Html.DisplayFor(m => item.AverageMileage)</td>
                                <td style="text-align:center">@Html.DisplayFor(m => item.TotalTravelTime)</td>
                                <td style="text-align:center">@Html.DisplayFor(m => item.AverageTravelTime)</td>
                            </tr>
                        }
                    }
                }
            </tbody>
        </table><br /><br /><br />

        <div class="container-fluid" style="width:100%; height:auto" align="center">
            <div class="row" style="width:100%" align="center">
                <div class="jumbotron" style="width:9%; height:12vw; border:hidden; background-color:white; border-top-color:white"></div>
                <div class="jumbotron" style="width:40%; height:12vw; border:hidden; background-color:white; border-top-color:white">
                    <p align="center"><strong><span style="font-size: 18pt">List of vehicles used</span></strong></p>
                    <table class="taskList" style="width: 98%; border-collapse: collapse" bordercolor="black" cellspacing="0" cellpadding="1" align="center" border="1">
                        <tbody>
                            <tr style="background-color:#bfffdb">
                                <td style="text-align:center" rowspan="1" colspan="6"><strong>Vehicles used &nbsp; ( Start date: @Model.DateFROM.Value.ToString("yyyy-MM-dd") &nbsp; - &nbsp; End date: @Model.DateTO.Value.ToString("yyyy-MM-dd") )</strong></td>
                            </tr>
                            @{
                                if (Model._tripReportRaw != null)
                                {
                                    foreach (var item in Model._DMCVehicleList)
                                    {
                                        <tr>
                                            <td style="text-align:center">@Html.DisplayFor(m => item)</td>
                                        </tr>
                                    }
                                }
                            }
                        </tbody>
                    </table><br />
                </div>
                <div class="jumbotron" style="width:1%; height:12vw; border:hidden; background-color:white; border-top-color:white"></div>
                <div class="jumbotron" style="width:40%; height:12vw; border:hidden; background-color:white; border-top-color:white">
                    <p align="center"><strong><span style="font-size: 18pt">List of vehicles not used</span></strong></p>
                    <table class="taskList" style="width: 98%; border-collapse: collapse" bordercolor="black" cellspacing="0" cellpadding="1" align="center" border="1">
                        <tbody>
                            <tr style="background-color:#bfffdb">
                                <td style="text-align:center" rowspan="1" colspan="6"><strong>Vehicles not used &nbsp; ( Start date: @Model.DateFROM.Value.ToString("yyyy-MM-dd") &nbsp; - &nbsp; End date: @Model.DateTO.Value.ToString("yyyy-MM-dd") )</strong></td>
                            </tr>
                            @{
                                if (Model._tripReportRaw != null)
                                {
                                    foreach (var item in Model._DMCVehicleNotUsedList)
                                    {
                                        <tr>
                                            <td style="text-align:center">@Html.DisplayFor(m => item)</td>
                                        </tr>
                                    }
                                }
                            }
                        </tbody>
                    </table><br />
                </div>
                <div class="jumbotron" style="width:9%; height:12vw; border:hidden; background-color:white; border-top-color:white"></div>
            </div>
        </div>
    }
}

<br /><br /><br />


<script src="~/Scripts/jquery-3.3.1.min.js"></script>
<script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>
<script type="text/javascript">
    function GenerateExcel() {
        window.open("/Reports/CreateExcel");
    }
</script>
